% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.heatmap.r
\name{utils.heatmap}
\alias{utils.heatmap}
\title{Enhanced Heat Map}
\usage{
utils.heatmap(
  x,
  Rowv = TRUE,
  Colv = if (symm) "Rowv" else TRUE,
  distfun = dist,
  hclustfun = hclust,
  dendrogram = c("both", "row", "column", "none"),
  reorderfun = function(d, w) reorder(d, w),
  symm = FALSE,
  scale = c("none", "row", "column"),
  na.rm = TRUE,
  revC = identical(Colv, "Rowv"),
  add.expr,
  breaks,
  symbreaks = any(x < 0, na.rm = TRUE) || scale != "none",
  col = "heat.colors",
  colsep,
  rowsep,
  sepcolor = "white",
  sepwidth = c(0.05, 0.05),
  cellnote,
  notecex = 1,
  notecol = "cyan",
  na.color = par("bg"),
  trace = c("column", "row", "both", "none"),
  tracecol = "cyan",
  hline = median(breaks),
  vline = median(breaks),
  linecol = tracecol,
  margins = c(5, 5),
  ColSideColors = NULL,
  RowSideColors = NULL,
  cexRow = 0.2 + 1/log10(nr),
  cexCol = 0.2 + 1/log10(nc),
  labRow = NULL,
  labCol = NULL,
  srtRow = NULL,
  srtCol = NULL,
  adjRow = c(0, NA),
  adjCol = c(NA, 0),
  offsetRow = 0.5,
  offsetCol = 0.5,
  colRow = NULL,
  colCol = NULL,
  key = TRUE,
  keysize = 1.5,
  density.info = c("histogram", "density", "none"),
  denscol = tracecol,
  symkey = any(x < 0, na.rm = TRUE) || symbreaks,
  densadj = 0.25,
  key.title = NULL,
  key.xlab = NULL,
  key.ylab = NULL,
  key.xtickfun = NULL,
  key.ytickfun = NULL,
  key.par = list(),
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  lmat = NULL,
  lhei = NULL,
  lwid = NULL,
  extrafun = NULL,
  ...
)
}
\arguments{
\item{x}{Numeric matrix of the values to be plotted.}

\item{Rowv}{Logical, dendrogram, or vector. Controls row‐dendrogram creation and/or reordering.}

\item{Colv}{Logical, dendrogram, or vector. Controls column‐dendrogram creation and/or reordering; may be "Rowv" for square matrices.}

\item{distfun}{Function to compute distances; defaults to \code{\link{dist}}.}

\item{hclustfun}{Function to cluster; defaults to \code{\link{hclust}}.}

\item{dendrogram}{Which dendrogram(s) to draw: "both", "row", "column", or "none".}

\item{reorderfun}{Function to reorder dendrogram given weights.}

\item{symm}{Logical; treat \code{x} symmetrically (only for square matrices).}

\item{scale}{Character: "none", "row", or "column" scaling of \code{x}.}

\item{na.rm}{Logical; remove \code{NA}s in scaling and computations.}

\item{revC}{Logical; reverse column order for plotting.}

\item{add.expr}{Expression to evaluate after the heat map image is drawn.}

\item{breaks}{Numeric vector or integer: breakpoints for color bins.}

\item{symbreaks}{Logical; force symmetric breaks around zero.}

\item{col}{Color palette or function; defaults to \code{heat.colors}.}

\item{colsep, rowsep}{Integer vectors; where to put separator lines between blocks.}

\item{sepcolor}{Color for separators.}

\item{sepwidth}{Numeric vector of length 2; widths of separators relative to cell size.}

\item{cellnote}{Optional character matrix for annotating each cell.}

\item{notecex}{Numeric; scaling for \code{cellnote}.}

\item{notecol}{Color for \code{cellnote}; default "cyan".}

\item{na.color}{Color for \code{NA} cells; defaults to plotting background.}

\item{trace}{Character: "column", "row", "both", or "none" for trace lines.}

\item{tracecol}{Color for trace lines.}

\item{hline, vline}{Numeric vectors; values at which to draw horizontal/vertical lines.}

\item{linecol}{Color for \code{hline}/\code{vline}.}

\item{margins}{Numeric vector of length 2; margins for column and row labels.}

\item{ColSideColors, RowSideColors}{Optional color vectors for side bars [default NULL].}

\item{cexRow, cexCol}{Numeric; character expansion for row/column labels.}

\item{labRow, labCol}{Character vectors of labels; defaults to row/column names.}

\item{srtRow, srtCol}{Rotation angles for row/column labels.}

\item{adjRow, adjCol}{Justification for row/column labels.}

\item{offsetRow, offsetCol}{Numeric offsets (in character widths) for labels.}

\item{colRow, colCol}{Color(s) for row/column label text.}

\item{key}{Logical; draw a color key.}

\item{keysize}{Numeric; size of the color key.}

\item{density.info}{Character: "histogram", "density", or "none" on the key.}

\item{denscol}{Color for density plot.}

\item{symkey}{Logical; symmetric key around zero.}

\item{densadj}{Numeric; adjustment for density bandwidth.}

\item{key.title, key.xlab, key.ylab}{Main title and axis labels for key.}

\item{key.xtickfun, key.ytickfun}{Functions for tick placement on key axes.}

\item{key.par}{List of graphical parameters for the key.}

\item{main, xlab, ylab}{Main title and axis labels for the heat map.}

\item{lmat}{Matrix specifying layout positions.}

\item{lhei}{Numeric vector specifying row heights in layout.}

\item{lwid}{Numeric vector specifying column widths in layout.}

\item{extrafun}{Function to call after plotting (e.g. add scatterplot).}

\item{...}{Additional arguments passed to \code{\link{image}}.}
}
\value{
Invisibly, a list with components:
\describe{
  \item{rowInd}{Row permutation vector.}
  \item{colInd}{Column permutation vector.}
  \item{call}{Matched function call.}
  \item{rowMeans,rowSDs}{Row means and SDs (if \code{scale="row"}).}
  \item{colMeans,colSDs}{Column means and SDs (if \code{scale="column"}).}
  \item{carpet}{Reordered/scaled matrix used for the image.}
  \item{rowDendrogram,colDendrogram}{Dendrogram objects.}
  \item{breaks}{Breakpoints used for colors.}
  \item{col}{Colors used.}
  \item{vline,hline}{Center‐line values for trace (if used).}
  \item{colorTable}{Data frame of color bins and ranges.}
  \item{layout}{List with \code{lmat}, \code{lhei}, \code{lwid}.}
}
}
\description{
A heat map is a false‐color image with optional row/column dendrograms
and extensive customization of scaling, coloring, labeling, and layout.
}
\details{
If \code{Rowv} or \code{Colv} are dendrograms, they are honored
without reordering; otherwise they are computed via
\code{as.dendrogram(hclustfun(distfun(...)))} and optionally reordered.

Scaling centers and scales rows or columns when requested.  The
default color palette may be enhanced via packages such as
\pkg{RColorBrewer}.  Layout may be customized with
\code{lmat}, \code{lwid}, and \code{lhei} as in \code{\link[graphics]{layout}}.
}
\note{
The original rows and columns are reordered to match the dendrograms.
Because \code{heatmap.2} uses \code{\link{layout}}, it cannot be used
inside another layout (e.g. \code{par(mfrow=...)}).
}
\examples{
data(mtcars)
x <- as.matrix(mtcars)
utils.heatmap(x)
utils.heatmap(x, dendrogram = "none")
utils.heatmap(x, scale = "row", col = cm.colors(255))
}
\author{
Andy Liaw (original); R. Gentleman, M. Maechler, W. Huber, G. Warnes (revisions)
}
